% Copyright (C) 2008 Bert Burgemeister
%
% Permission is granted to copy, distribute and/or modify this
% document under the terms of the GNU Free Documentation License,
% Version 1.2 or any later version published by the Free Software
% Foundation; with no Invariant Sections, no Front-Cover Texts and
% no Back-Cover Texts. For details see file COPYING.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Structures}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{LIST}{1cm}
  
  \IT{(\FU*{SLOT-EXISTS-P} \VAR{foo} \VAR{bar})}
  {
  \retval{\T} if \VAR{foo} has a slot \VAR{bar}.
  }

  \IT{(\MC*{DEFSTRUCT}%FIXME:AUGMENT:print-object, constructor
    \GOO{\VAR{foo}\XOR
      (\VAR{foo}
      \orGOO{%
        \xorGOO{%
          \kwd{:conc-name}\\
          (\kwd{:conc-name } \Op{\VAR{slot-prefix}\DF{\VAR{foo}\LIT{-}}})}{.}\\
        \xorGOO{%
          \kwd{:constructor}\\
          (\kwd{:constructor }
          \OP{\VAR{maker}\DF{\LIT{MAKE-}\VAR{foo}}\text{ }
            \Op{({\OPn{\VAR{arg}}})}})}{\}^{\!\!*}}\\
        \xorGOO{%
          \kwd{:copier}\\
          (\kwd{:copier }
          \Op{\VAR{copier}\DF{\LIT{COPY-}\VAR{foo}}})}{.}\\
        (\kwd{:include} \VAR{ struct}\text{ }
        \xorGOO{%
          \VAR{slot}\\
          (\VAR{slot } \Op{\VAR{init}\text{ }
            \orGOO{
              \kwd{:type } \NEV{\VAR{type}}\\
              \kwd{:read-only } \NEV{\VAR{bool}}}{\}}})\\
        }{\}^{\!\!*}})\\
        (\kwd{:type } \xorGOO{\kwd{list}\\
          \kwd{vector}\\
          (\kwd{vector}\VAR{ size})}{\}})\text{ }
        \orGOO{%
          \kwd{:named}\\
          (\kwd{:initial-offset} \VAR{ n})\\
          \xorGOO{
            (\kwd{:print-object } \Op{\VAR{printer}})\\
            (\kwd{:print-function } \Op{\VAR{printer}})
          }{.}%
        }{.}\\
        \xorGOO{%
          \kwd{:predicate}\\
          (\kwd{:predicate } \Op{\VAR{p-name}\DF{\VAR{foo}\LIT{-P}}})}{.}
      }{\}}%
      )%
    }
    \Op{\NEV{\VAR{doc}}}
    \xorGOO{
      \VAR{slot}\\
      (\VAR{slot } \Op{\VAR{init}\text{ }
        \orGOO{
          \kwd{:type } \NEV{\VAR{type}}\\
          \kwd{:read-only } \NEV{\VAR{bool}}
        }{\}}})
    }{\}^{\!\!*}}%
    )}
  {
  Define structure \retval{\VAR{foo}} together with functions
  \LIT{MAKE-}\VAR{foo}, \LIT{COPY-}\VAR{foo} and
  \VAR{foo}\LIT{-P}; and \kwd{setf}able accessors \VAR{foo}\LIT{-}\VAR{slot}.
  }

  \IT{(\FU*{COPY-STRUCTURE} \VAR{structure})}
  {
  Return \retval{copy of \VAR{structure}} with shared slot values.
  }

\end{LIST}


